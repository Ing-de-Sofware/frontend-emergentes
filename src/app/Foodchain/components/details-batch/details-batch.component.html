<div class="page-content">
  <div *ngIf="isLoading" class="state-message loading">
    Cargando detalles del lote...
  </div>
  <div *ngIf="errorMessage" class="state-message error">
    <i class="fas fa-exclamation-triangle"></i> Error: {{ errorMessage }}
  </div>

  <div *ngIf="batch" class="batch-detail-container">

    <h1 class="lot-title">
      {{ batch.lotName }} — Lot Detail
    </h1>
    <p class="lot-description">
      Administre este lote y genere su código QR único para etiquetar los paquetes.
    </p>

    <div class="tabs-navigation">
      <div
        class="tab-item"
        [class.active]="currentView === 'summary'"
        (click)="changeView('summary')">
        Lot Summary
      </div>
      <div
        class="tab-item"
        [class.active]="currentView === 'history'"
        (click)="changeView('history')">
        History
      </div>
      <div
        class="tab-item"
        [class.active]="currentView === 'qr'"
        (click)="changeView('qr')">
        QR & Labels
      </div>
    </div>

    <div *ngIf="currentView === 'summary'" class="tab-content summary-content">
      <div class="summary-grid">
        <div class="summary-details">
          <h2>Summary Details</h2>
          <div class="detail-row">
            <span class="label">Lot Name:</span>
            <span class="value">{{ batch.lotName }}</span>
          </div>
          <div class="detail-row">
            <span class="label">Farm Name:</span>
            <span class="value">{{ batch.farmName }}</span>
          </div>
          <div class="detail-row">
            <span class="label">Variety:</span>
            <span class="value">{{ batch.variety }}</span>
          </div>
          <div class="detail-row">
            <span class="label">Harvest Date:</span>
            <span class="value">{{ batch.harvestDate }}</span>
          </div>
          <div class="detail-row">
            <span class="label">Created At:</span>
            <span class="value">{{ batch.createdDate }}</span>
          </div>
          <div class="detail-row">
            <span class="label">State:</span>
            <span class="value state-{{ batch.state.toLowerCase() }}">{{ batch.state }}</span>
          </div>
          <div class="detail-row detail-id">
            <span class="label">Internal Lot ID:</span>
            <span class="value">{{ batch.id }}</span>
          </div>
          <button class="copy-button">Copy Lot ID / Story</button>
        </div>

        <div class="summary-image-wrapper">
          <img [src]="batch.imageUrl" alt="Lot Image" class="lot-image" onerror="this.onerror=null; this.src='https://placehold.co/400x300/1a4314/ffffff?text=No+Image'">
        </div>
      </div>
    </div>

    <div *ngIf="currentView === 'history'" class="tab-content placeholder-content">
      <h3>Historial del Lote</h3>
      <p>Aquí se cargará y mostrará la trazabilidad completa del lote.</p>
    </div>

    <div *ngIf="currentView === 'qr'" class="tab-content placeholder-content">
      <h3>Generación de Códigos QR</h3>
      <p>Próximamente: Opciones para generar y descargar etiquetas QR.</p>
    </div>
  </div>
</div>
